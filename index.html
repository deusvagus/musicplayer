<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>音樂資料查詢</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>
<body class="dark-theme">

  <div class="page-container">
    <header class="header">
      <div class="header-left">
        <button id="tocToggleMobile" class="toc-toggle-mobile" aria-label="開啟專輯目錄">
          <i class="fas fa-bars"></i>
        </button>
        <i class="fas fa-music"></i>
        <h2>音樂資料查詢</h2>
      </div>
<div class="search-controls">
        <div class="search-layout-grid">
          <select id="shortcutField" class="shortcut-select"></select>
          <select id="shortcutPersonnel" class="shortcut-select">
            <option value="">快捷輸入人員</option>
          </select>
          <div class="regex-toggle">
            <input type="checkbox" id="multiSelectToggle">
            <label for="multiSelectToggle">快捷多選模式</label>
          </div>

          <div class="input-group">
            <div class="input-wrapper">
              <input type="search" id="searchField" placeholder="輸入搜尋欄位" class="search-input-adv" autocomplete="off">
              <span id="searchFieldPill" class="input-pill"></span>
              <button class="clear-input-btn" id="clearSearchField" title="清除欄位">&times;</button>
              <div id="field-suggestions" class="suggestions-box"></div>
            </div>
            <div class="regex-toggle">
              <input type="checkbox" id="fieldRegexToggle">
              <label for="fieldRegexToggle">Regex</label>
            </div>
          </div>
          <div class="input-group">
            <div class="input-wrapper">
              <input type="search" id="searchValue" placeholder="輸入搜尋內容" class="search-input-adv" autocomplete="off">
              <button class="clear-input-btn" id="clearSearchValue" title="清除內容">&times;</button>
              <div id="value-suggestions" class="suggestions-box"></div>
            </div>
            <div class="regex-toggle">
              <input type="checkbox" id="valueRegexToggle">
              <label for="valueRegexToggle">Regex</label>
            </div>
          </div>
          <div class="search-actions">
            <button id="searchHelpBtn" class="theme-toggle" aria-label="搜尋語法提示">
              <i class="fas fa-question-circle"></i>
            </button>
            <button id="searchSortToggle" class="theme-toggle" aria-label="反轉搜尋結果">
                <i class="fas fa-retweet"></i>
            </button>
          </div>
        </div>
      </div>
      <div class="header-right">
        <button id="exportBtn" class="theme-toggle" aria-label="匯出搜尋結果">
          <i class="fas fa-download"></i>
        </button>
        <button id="themeToggle" class="theme-toggle" aria-label="切換主題">
          <i class="fas fa-sun"></i>
        </button>
      </div>
    </header>

    <div class="app-body">
      <aside class="sidebar">
        <div class="sidebar-sticky">
          <div class="sidebar-header">
            <h2>專輯目錄</h2>
            <div class="sidebar-header-right">
              <button id="sortToggle" class="sort-toggle" title="切換專輯排序">
                <i class="fas fa-sort"></i>
              </button>
              <button id="tocCollapseToggle" class="toc-collapse-toggle" title="收合/展開目錄">
                <i class="fas fa-chevron-down"></i>
              </button>
            </div>
          </div>
          <div id="collapsibleTocContent" class="collapsible-content">
            <div class="album-search-controls">
              <div class="input-wrapper">
                <input type="search" id="searchInput" placeholder="搜尋專輯..." class="search-input">
                <button class="clear-input-btn" id="clearSearchInput" title="清除搜尋">&times;</button>
              </div>
              <div class="quick-search-buttons">
                <button class="quick-search-btn" data-query="原神">原神</button>
                <button class="quick-search-btn" data-query="崩坏星穹铁道">崩坏星穹铁道</button>
              </div>
            </div>
            <nav id="toc" class="table-of-contents"></nav>
          </div>
        </div>
        <div class="resizer" id="left-resizer"></div>
      </aside>

      <main class="main-content" id="albumContainer">
        <div id="skeleton-loader">
          <div class="skeleton-summary"></div>
          <div class="music-grid">
            <div class="skeleton-card"></div><div class="skeleton-card"></div>
            <div class="skeleton-card"></div><div class="skeleton-card"></div>
            <div class="skeleton-card"></div><div class="skeleton-card"></div>
          </div>
          <div class="skeleton-summary"></div>
          <div class="music-grid">
            <div class="skeleton-card"></div><div class="skeleton-card"></div>
            <div class="skeleton-card"></div>
          </div>
        </div>
      </main>

      <aside id="details-sidebar" class="details-sidebar">
        <button id="close-sidebar-btn" class="close-btn">&times;</button>
        <div id="sidebar-content" class="sidebar-content"></div>
        <div class="resizer" id="right-resizer"></div>
      </aside>
    </div>
  </div>

  <div id="sticky-player" class="sticky-player">
    <button id="close-sticky-player-btn" class="close-btn mini-close-btn">&minus;</button>
    
    <div class="sticky-player-inner">
      <div id="sticky-player-content"></div>
    </div>
    </div>

  <div id="sidebar-backdrop" class="sidebar-backdrop"></div>
  <div id="details-backdrop" class="details-backdrop"></div>
  
  <div id="helpModal" class="help-modal">
    <div class="help-modal-content">
      <button class="help-modal-close">&times;</button>
      <h2>搜尋語法提示</h2>
      <div class="help-section">
        <h4>1. 關鍵字搜尋 (預設模式)</h4>
        <p><strong>多關鍵字</strong>: 輸入多個詞，會找出<strong>同時包含</strong>所有關鍵字的曲目 (AND 關係)。</p>
        <p class="example" data-field-value="作曲" data-search-value="苑迪萌 姜以君"><em>舉例:</em> 快捷输入「作曲」并在「內容」搜尋 <code>苑迪萌 姜以君</code>，會找到所有由 <code>苑迪萌 姜以君</code> 參與 <code>作曲</code> 的曲目。<button class="apply-example-btn">套用</button></p>
        <p><strong>完整詞組</strong>: 使用 <code>"英文雙引號"</code> 包覆文字，可搜尋完整的詞組。</p>
        <p class="example" data-field-value='' data-search-value='"Budapest Scoring Orchestra"'><em>舉例:</em> 在「內容」搜尋 <code>"Budapest Scoring Orchestra"</code> 可精確查詢，避免查詢到單獨的 <code>Orchestra</code> 造成結果中出現其他樂團。<button class="apply-example-btn">套用</button></p>
      </div>
      <div class="help-section">
        <h4>2. 正規表示式 (Regex)</h4>
        <p>勾選 "Regex" 後啟用，可用於模糊、複雜的模式匹配。以下為常用規則：</p>
        <ul class="help-regex-list">
          <li><code>|</code> (或): 匹配多個項目中的任意一個。</li>
          <li class="example" data-field-value="作曲" data-search-value="丁谦|李洋" data-value-regex="true"><em>舉例:</em> 在欄位中選擇「作曲」，並於「內容」搜尋 <code>丁谦|李洋</code>，會找到丁谦**或**李洋作曲的所有曲目。<button class="apply-example-btn">套用</button></li>

          <li><code>^</code> (開頭): 匹配文字的開頭。</li>
          <li class="example" data-field-value="作曲" data-search-value="^尤裴佳" data-value-regex="true"><em>舉例:</em> 在欄位中選擇「作曲」，並於「內容」搜尋 <code>^尤裴佳</code>，只會找到作曲家列表**開頭**是尤裴佳的曲目。<button class="apply-example-btn">套用</button></li>
          
          <li><code>$</code> (結尾): 匹配文字的結尾。</li>
          <li class="example" data-search-value="\(HOYO-MiX\)$" data-value-regex="true"><em>舉例:</em> 在任意欄位中，於「內容」搜尋 <code>\(HOYO-MiX\)$</code>，會找到所有以 `(HOYO-MiX)` 結尾的資訊 (注意 `()` 需用 `\` 轉義)。<button class="apply-example-btn">套用</button></li>

          <li><code>()</code> (分組): 將多個字元組合成一個單元，常用於搭配 `|`。</li>
          <li class="example" data-field-value="作曲" data-search-value="(陈|车)子(玉|敏)" data-value-regex="true"><em>舉例:</em> 在欄位中選擇「作曲」，搜尋 <code>(陈|车)子(玉|敏)</code>，會找到…陈子敏和车子玉作曲的曲目(doge)。<button class="apply-example-btn">套用</button></li>
          
          <li><code>.</code> (任意單字元): 匹配除換行符外的任意一個字元。</li>
          <li class="example" data-field-value="作曲" data-search-value=".子." data-value-regex="true"><em>舉例:</em> 在欄位中選擇「作曲」，搜尋 <code>.子.</code>…也會找到陈子敏和车子玉作曲的曲目(doge)。<button class="apply-example-btn">套用</button></li>
        </ul>
        <p class="help-warning">注意：不合法的 Regex 語法會導致輸入框變紅且搜尋無效。</p>
      </div>
    </div>
  </div>

  <div id="exportModal" class="help-modal">
    <div class="help-modal-content">
      <button id="exportModalClose" class="help-modal-close">&times;</button>
      <h2>匯出搜尋結果</h2>
      <div class="export-options">
        <div class="export-option-group">
          <h4>匯出欄位</h4>
          <label><input type="radio" name="exportFields" value="matched" checked> 僅匯出搜尋匹配的欄位</label>
          <label><input type="radio" name="exportFields" value="all"> 匯出全部欄位</label>
        </div>
      </div>
      <button id="confirmExportBtn" class="load-player-btn" style="width: auto; margin-top: 1.5rem;">確認匯出</button>
    </div>
  </div>


  <script src="script.js?v=6.0.6" defer></script>
</body>
</html>